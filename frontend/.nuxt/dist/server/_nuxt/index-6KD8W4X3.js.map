{"version":3,"file":"index-6KD8W4X3.js","sources":["../../../../components/SearchBar.vue","../../../../components/BookCard.vue","../../../../composables/useApi.ts","../../../../stores/useSearchStore.ts","../../../../pages/index.vue"],"sourcesContent":["<script setup lang=\"ts\">\nconst model = defineModel<string>({ default: \"\" });\nconst emit = defineEmits([\"search\"]);\nfunction onSubmit(e: Event){ e.preventDefault(); emit(\"search\", model.value); }\n</script>\n<template>\n  <form @submit=\"onSubmit\" class=\"card\" style=\"display:grid; gap:12px;\">\n    <input class=\"input\" v-model=\"model\" placeholder=\"Escribe el nombre de un Libro para continuar\" />\n    <button class=\"button\" type=\"submit\">Buscar</button>\n  </form>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\n\nconst props = defineProps<{\n  id: string\n  title: string\n  author?: string\n  cover?: string | null\n  year?: number | null\n}>()\n\nconst to = computed(() => {\n  const path = '/libro/' + encodeURIComponent(props.id)\n  const q: Record<string, string> = {}\n  if (props.title)  q.title  = props.title\n  if (props.author) q.author = props.author\n  if (props.year != null) q.year = String(props.year)\n  if (props.cover) q.cover  = props.cover\n  const query = new URLSearchParams(q).toString()\n  return `${path}${query ? `?${query}` : ''}`\n})\n</script>\n\n<template>\n  <NuxtLink :to=\"to\" class=\"card\" style=\"display:grid;gap:8px;\">\n    <img\n      v-if=\"cover\"\n      :src=\"cover\"\n      alt=\"portada\"\n      style=\"width:100%;aspect-ratio:2/3;object-fit:cover;border-radius:10px;\"\n    />\n    <div>\n      <strong>{{ title }}</strong>\n      <div><small class=\"muted\">{{ author }} <span v-if=\"year\">· {{ year }}</span></small></div>\n    </div>\n  </NuxtLink>\n</template>\n","import axios from \"axios\";\nexport function useApi(){\n  const config = useRuntimeConfig();\n  const http = axios.create({ baseURL: config.public.apiBase + \"/api\" });\n  const user = process.client ? localStorage.getItem(\"basic_user\") : null;\n  const pass = process.client ? localStorage.getItem(\"basic_pass\") : null;\n  if (user && pass) {\n    // @ts-ignore\n    http.defaults.headers.common[\"Authorization\"] = \"Basic \" + btoa(`${user}:${pass}`);\n  }\n  return {\n    search: (q: string) => http.get(\"/books/search\", { params: { q } }).then(r=>r.data),\n    lastSearch: () => http.get(\"/books/last-search\").then(r=>r.data),\n    save: (payload: any) => http.post(\"/books/my-library\", payload).then(r=>r.data),\n    list: (params: any={}) => http.get(\"/books/my-library\", { params }).then(r=>r.data),\n    getById: (id: string) => http.get(`/books/my-library/${id}`).then(r=>r.data),\n    update: (id: string, payload: any) => http.put(`/books/my-library/${id}`, payload).then(r=>r.data),\n    remove: (id: string) => http.delete(`/books/my-library/${id}`).then(r=>r.data),\n    frontCover: (openLibraryId: string) =>\n      http.get(`/books/my-library/front-cover/${encodeURIComponent(openLibraryId)}`).then(r=>r.data),\n  };\n}\n","import { defineStore } from 'pinia';\nexport const useSearchStore = defineStore('search', {\n  state: () => ({ last: [] as string[], results: [] as any[], loading: false }),\n  actions: {\n    async fetchLast(){\n      const { lastSearch } = useApi();\n      this.last = await lastSearch();\n    },\n    async search(q: string){\n      const { search } = useApi();\n      this.loading = true;\n      try { this.results = await search(q); }\n      finally { this.loading = false; }\n    }\n  }\n});\n","<script setup lang=\"ts\">\nconst q = ref(\"\");\nconst searchStore = useSearchStore();\nonMounted(() => searchStore.fetchLast());\nasync function doSearch(query:string){ await searchStore.search(query); }\n</script>\n<template>\n  <div class=\"grid\" style=\"gap:24px;\">\n    <SearchBar v-model=\"q\" @search=\"doSearch\" />\n\n    <div class=\"card\" v-if=\"searchStore.last.length\">\n      <strong>Últimas búsquedas</strong>\n      <div style=\"display:flex; gap:8px; flex-wrap:wrap; margin-top:8px;\">\n        <button class=\"button secondary\" v-for=\"s in searchStore.last\" :key=\"s\" @click=\"doSearch(s)\">{{ s }}</button>\n      </div>\n    </div>\n\n    <div v-if=\"searchStore.loading\">Buscando...</div>\n    <div v-else-if=\"!searchStore.results.length\" class=\"card\">No hay resultados todavía</div>\n    <div v-else class=\"grid books\">\n      <BookCard v-for=\"b in searchStore.results\" :key=\"b.id\" :id=\"b.id\" :title=\"b.title\" :author=\"b.author\" :year=\"b.year\" :cover=\"b.cover\" />\n    </div>\n  </div>\n</template>\n"],"names":["_useModel","_push","_parent","cover","_ssrRenderAttr","title","author","year","_createBlock","_createVNode","_toDisplayString","_unref"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AACA,UAAM,QAAQA,SAAmB,SAAA,YAAgB;;;QAKtB,OAAM;AAAA,QAAO,OAAA,EAAA,WAAA,QAAA,OAAA,OAAA;AAAA,MAAA,0DACN,MAAA,KAAK;;;;;;;;;;;;;;;;;;;;;ACJvC,UAAM,QAAQ;AAQd,UAAM,KAAK,SAAS,MAAM;AACxB,YAAM,OAAO,YAAY,mBAAmB,MAAM,EAAE;AACpD,YAAM,IAA4B,CAAA;AAClC,UAAI,MAAM,MAAQ,GAAE,QAAS,MAAM;AACnC,UAAI,MAAM,OAAQ,GAAE,SAAS,MAAM;AACnC,UAAI,MAAM,QAAQ,QAAQ,OAAO,OAAO,MAAM,IAAI;AAClD,UAAI,MAAM,MAAO,GAAE,QAAS,MAAM;AAClC,YAAM,QAAQ,IAAI,gBAAgB,CAAC,EAAE,SAAA;AACrC,aAAO,GAAG,IAAI,GAAG,QAAQ,IAAI,KAAK,KAAK,EAAE;AAAA,IAC3C,CAAC;;;;QAIY,IAAI,GAAA;AAAA,QAAI,OAAM;AAAA,QAAO,OAAA,EAAA,WAAA,QAAA,OAAA,MAAA;AAAA,MAAA;yBAAhC,CAWW,GAAAC,QAAAC,UAAA,aAAA;;gBATDC,KAAAA,OAAK;4BACVC,cAAA,OAAKD,KAAAA,KAAK,yCAEX,EAAA,SAAA,QAAA,gBAAA,OAAA,cAAA,SAAA,iBAAA,QAAwE;;;;wEAG7DE,KAAAA,KAAK,4EACaC,KAAAA,MAAM;gBAAgBC,KAAAA,MAAI;0DAAOA,KAAAA,IAAI;;;;;;;cAP5DJ,KAAAA,sBADRK,YAKE,OAAA;AAAA;gBAHC,KAAKL,KAAAA;AAAAA,gBACN,KAAI;AAAA,gBACJ,OAAA,EAAA,SAAA,QAAA,gBAAA,OAAA,cAAA,SAAA,iBAAA,OAAA;AAAA,cAAA;cAEFM,YAGM,OAAA,MAAA;AAAA,gBAFJA,YAA4B,gCAAjBJ,KAAAA,KAAK,GAAA,CAAA;AAAA,gBAChBI,YAA0F,OAAA,MAAA;AAAA,kBAArFA,YAA+E,SAAA,EAAxE,OAAM,WAAO;AAAA,oBAAIH,gBAAAA,gBAAAA,KAAAA,MAAM,IAAG,KAAC,CAAA;AAAA,oBAAYC,KAAAA,qBAAZC,YAAqC,QAAA,EAAA,KAAA,EAAA,GAAnB,OAAEE,gBAAGH,KAAAA,IAAI,GAAA,CAAA;;;;;;;;;;;;;;;;;;AChCjE,SAAS,SAAQ;AACtB,QAAM,SAAS,iBAAA;AACf,QAAM,OAAO,MAAM,OAAO,EAAE,SAAS,OAAO,OAAO,UAAU,QAAQ;AAOrE,SAAO;AAAA,IACL,QAAQ,CAAC,MAAc,KAAK,IAAI,iBAAiB,EAAE,QAAQ,EAAE,EAAA,GAAK,EAAE,KAAK,CAAA,MAAG,EAAE,IAAI;AAAA,IAClF,YAAY,MAAM,KAAK,IAAI,oBAAoB,EAAE,KAAK,CAAA,MAAG,EAAE,IAAI;AAAA,IAC/D,MAAM,CAAC,YAAiB,KAAK,KAAK,qBAAqB,OAAO,EAAE,KAAK,CAAA,MAAG,EAAE,IAAI;AAAA,IAC9E,MAAM,CAAC,SAAY,CAAA,MAAO,KAAK,IAAI,qBAAqB,EAAE,OAAA,CAAQ,EAAE,KAAK,CAAA,MAAG,EAAE,IAAI;AAAA,IAClF,SAAS,CAAC,OAAe,KAAK,IAAI,qBAAqB,EAAE,EAAE,EAAE,KAAK,CAAA,MAAG,EAAE,IAAI;AAAA,IAC3E,QAAQ,CAAC,IAAY,YAAiB,KAAK,IAAI,qBAAqB,EAAE,IAAI,OAAO,EAAE,KAAK,CAAA,MAAG,EAAE,IAAI;AAAA,IACjG,QAAQ,CAAC,OAAe,KAAK,OAAO,qBAAqB,EAAE,EAAE,EAAE,KAAK,CAAA,MAAG,EAAE,IAAI;AAAA,IAC7E,YAAY,CAAC,kBACX,KAAK,IAAI,iCAAiC,mBAAmB,aAAa,CAAC,EAAE,EAAE,KAAK,CAAA,MAAG,EAAE,IAAI;AAAA,EAAA;AAEnG;ACpBO,MAAM,iBAAiB,YAAY,UAAU;AAAA,EAClD,OAAO,OAAO,EAAE,MAAM,CAAA,GAAgB,SAAS,IAAa,SAAS;EACrE,SAAS;AAAA,IACP,MAAM,YAAW;AACf,YAAM,EAAE,WAAA,IAAe,OAAA;AACvB,WAAK,OAAO,MAAM,WAAA;AAAA,IACpB;AAAA,IACA,MAAM,OAAO,GAAU;AACrB,YAAM,EAAE,OAAA,IAAW,OAAA;AACnB,WAAK,UAAU;AACf,UAAI;AAAE,aAAK,UAAU,MAAM,OAAO,CAAC;AAAA,MAAG,UAAA;AAC5B,aAAK,UAAU;AAAA,MAAO;AAAA,IAClC;AAAA,EAAA;AAEJ,CAAC;;;;;ACdD,UAAM,IAAI,IAAI,EAAE;AAChB,UAAM,cAAc,eAAA;AAEpB,mBAAe,SAAS,OAAa;AAAE,YAAM,YAAY,OAAO,KAAK;AAAA,IAAG;;;;;QAGjE,OAAM;AAAA,QAAO,OAAA,EAAA,OAAA,OAAA;AAAA,MAAA;;oBACII,MAAA,CAAA;AAAA,sDAAA,EAAC,QAAA,SAAA;AAAA,QAAG,UAAQ;AAAA,MAAA;UAERA,MAAA,WAAA,EAAY,KAAK,QAAM;gGAExC,EAAA,WAAA,QAAA,OAAA,OAAA,aAAA,QAAA,cAAA,MAAA,CAA8D,CAAA,YAAA;sBACpBA,MAAA,WAAA,EAAY,MAAI,CAArB,MAAC;mEAAuD,CAAC,CAAA,WAAA;AAAA;;;;;AAI1F,UAAAA,MAAA,WAAA,EAAY,SAAO;;kBACbA,MAAA,WAAA,EAAY,QAAQ,QAAM;;;;sBAEnBA,MAAA,WAAA,EAAY,SAAO,CAAxB,MAAC;;YAA0B,KAAK,EAAE;AAAA,YAAK,IAAI,EAAE;AAAA,YAAK,OAAO,EAAE;AAAA,YAAQ,QAAQ,EAAE;AAAA,YAAS,MAAM,EAAE;AAAA,YAAO,OAAO,EAAE;AAAA,UAAA;;;;;;;;;;;;;;"}